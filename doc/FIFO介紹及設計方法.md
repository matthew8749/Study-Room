# FIFOä»‹ç´¹åŠè¨­è¨ˆæ–¹æ³•

## 1.FIFO (First Input First Output) æ¶æ§‹
åœ¨æ•¸ä½é›»è·¯ä¸­ï¼ŒFIFO(First In, First Out)æ˜¯ä¸€ç¨®è³‡æ–™ç·©è¡å€(buffer)ï¼Œç”¨ä¾†æš«å­˜è³‡æ–™ä¸¦ç¢ºä¿è¼¸å…¥è³‡æ–™çš„é †åºåœ¨è¼¸å‡ºæ™‚ä¿æŒä¸è®Šï¼Œæ­¤è¨˜æ†¶é«”çš„è³‡æ–™å…ˆé€²å…ˆå‡º(å¾Œé€²å¾Œå‡º)ã€‚
æ ¹æ“šFIFOå·¥ä½œçš„æ™‚è„ˆåŸŸåˆ†ç‚ºå…©ç¨®:

- **åŒæ­¥FIFO:** æŒ‡<ins>è®€æ™‚è„ˆ</ins>å’Œ<ins>å¯«å…¥æ™‚è„ˆ</ins>ç‚ºåŒä¸€å€‹æ™‚è„ˆåœ¨æ™‚è„ˆæ²¿ä¾†è‡¨æ™‚åŒæ™‚ç™¼ç”Ÿè®€å¯«ã€‚
åŒæ­¥FIFOä¹‹æ‰€ä»¥ç¨±ç‚ºâ€œåŒæ­¥â€ï¼Œæ˜¯å› ç‚ºå®ƒæ¡ç”¨åŒæ­¥æ™‚è„ˆä¾†æ§åˆ¶è®€å¯«æ“ä½œã€‚
FIFOçš„è®€å¯«æŒ‡æ¨™èˆ‡æ™‚è„ˆåŒæ­¥æ›´æ–°ï¼Œè³‡æ–™èˆ‡æ™‚è„ˆåŒæ­¥åœ¨FIFOèˆ‡å¤–éƒ¨é›»è·¯ä¹‹é–“å‚³è¼¸ã€‚
ä¸»è¦ç”¨æ–¼åœ¨è³‡æ–™å‚³è¼¸é€Ÿç‡è¶…éè³‡æ–™è™•ç†é€Ÿç‡æ™‚ç·©è¡è³‡æ–™ã€‚é€™åœ¨é«˜é€Ÿç³»çµ±ä¸­ç‰¹åˆ¥é‡è¦ï¼Œå› ç‚ºæ™‚é–“å·®ç•°å¯èƒ½å°è‡´è³‡æ–™éºå¤±æˆ–æå£ã€‚
- **éåŒæ­¥FIFO:** è®€å¯«æ™‚è„ˆä¸ä¸€è‡´ï¼Œè®€å¯«ç›¸äº’ç¨ç«‹ã€‚æ‰€ä»¥å­˜åœ¨è·¨æ™‚è„ˆåŸŸçš„è™•ç†ã€‚

- ä¸€å€‹ç¡¬é«” FIFO é€šå¸¸åŒ…æ‹¬ä»¥ä¸‹éƒ¨åˆ†ï¼š
  - å„²å­˜é™£åˆ—ï¼ˆMemory Arrayï¼‰&ensp;&ensp;&ensp;&ensp;&nbsp;ï¼šæš«å­˜è³‡æ–™ã€‚
  - å¯«æŒ‡æ¨™ï¼ˆWrite Pointerï¼‰&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&nbsp;ï¼šæŒ‡å‡ºä¸‹ä¸€ç­†è³‡æ–™è¦å¯«å…¥çš„ä½ç½®ã€‚
  - è®€æŒ‡æ¨™ï¼ˆRead Pointerï¼‰&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&nbsp;ï¼šæŒ‡å‡ºä¸‹ä¸€ç­†è³‡æ–™è¦è®€å‡ºçš„è³‡æ–™ä½ç½®ã€‚
  - ç©º/æ»¿ è¨Šè™Ÿï¼ˆEmpty / Full Flagsï¼‰ï¼šåˆ¤æ–· FIFO æ˜¯å¦å·²æ»¿æˆ–å·²ç©ºã€‚

- å„²å­˜é™£åˆ—é€šå¸¸ä½¿ç”¨ RAM (Random Access Memory) å¯¦ç¾ã€‚ æ ¹æ“š FIFO çš„æ·±åº¦å’Œå¯¬åº¦ï¼ŒRAM å¯ä»¥æ˜¯å–®ç«¯å£ (single-port) æˆ–é›™ç«¯å£ (dual-port)ã€‚ é›™ç«¯å£ RAM å…è¨±åŒæ™‚é€²è¡Œè®€å¯«æ“ä½œï¼Œå¯ä»¥æé«˜ FIFO çš„æ€§èƒ½ã€‚
- RAM çš„é¸æ“‡æœƒå½±éŸ¿ FIFO çš„æ€§èƒ½å’Œè¤‡é›œåº¦ã€‚

<!-- é€™å¥çœ‹ä¸è¦‹ï¼Œä¸€å¥è©±çš„è¨»è§£ -->  
<!--
| æ³¨æ„éƒ¨åˆ†                         	| ä½œç”¨                             	|
|----------------------------------	|----------------------------------	|
| å„²å­˜é™£åˆ—ï¼ˆMemory Arrayï¼‰          | æš«å­˜è³‡æ–™ã€‚                       	|
| å¯«æŒ‡æ¨™ï¼ˆWrite Pointerï¼‰          	| æŒ‡å‡ºä¸‹ä¸€ç­†è³‡æ–™è¦å¯«å…¥çš„ä½ç½®ã€‚     	|
| è®€æŒ‡æ¨™ï¼ˆRead Pointerï¼‰           	| æŒ‡å‡ºä¸‹ä¸€ç­†è³‡æ–™è¦è®€å‡ºçš„è³‡æ–™ä½ç½®ã€‚ 	|
| ç©º/æ»¿ è¨Šè™Ÿï¼ˆEmpty / Full Flagsï¼‰ 	| åˆ¤æ–· FIFO æ˜¯å¦å·²æ»¿æˆ–å·²ç©ºã€‚       	|
 -->  


## åŒæ­¥FIFO(Synchronous FIFO)è¨­è¨ˆ

- é‡è¦åƒæ•¸  
`æ·±åº¦`ã€`å¯¬åº¦`ã€`ç©ºç™½æ¨™èªŒ`ã€`æ»¿æ¨™èªŒ`ã€`è®€å–æ™‚é˜`ã€`è®€æ™‚é‡`ã€`å¯«å…¥æ™‚é˜`å’Œ`å¯«å…¥æ™‚é‡`

- æ·±åº¦å’Œå¯¬åº¦  
`ä½å¯¬ WIDTH`ï¼šè¡¨ç¤ºFIFOè£¡é¢æ¯å€‹è³‡æ–™çš„å¤§å°  
`æ·±åº¦ DEPTH`ï¼šè¡¨ç¤ºFIFOèƒ½å­˜å¤šå°‘å€‹æ•¸æ“š

- è®€å–æ™‚é˜ and å¯«å…¥æ™‚é˜  
åœ¨åŒæ­¥FIFOä¸­é€™å…©å€‹æ˜¯ç›¸åŒçš„
clk degeä¾†æ™‚ï¼Œæœƒè®€å–å’Œå¯«å…¥data


- è®€æ™‚é‡(rd_ptr) and å¯«å…¥æ™‚é‡(wr_ptr)  
  - æŒ‡å‘ä¸‹ä¸€å€‹å³å°‡è¦è®€å–æˆ–å¯«å…¥çš„ä½ç½®ã€‚è®€å¯«æ“ä½œçš„åŸ·è¡Œå‰ææ˜¯è®€å¯«ä½¿èƒ½ä¿¡è™Ÿ (rd_en, wr_en) æœ‰æ•ˆï¼Œä¸¦ä¸” FIFO æ²’æœ‰æ»¿ (å°æ–¼å¯«å…¥) æˆ–ç©º (å°æ–¼è®€å–)ã€‚ åœ¨æ¯æ¬¡æˆåŠŸçš„è®€å¯«æ“ä½œ ä¹‹å¾Œï¼Œç›¸æ‡‰çš„æŒ‡é‡æœƒ éå¢ï¼ŒæŒ‡å‘ä¸‹ä¸€å€‹å¯ç”¨çš„ä½ç½®ã€‚  
  - å®ƒå€‘æ˜¯ç”¨ä¾†æŒ‡ç¤ºRAMä½å€çš„ç´¢å¼•ï¼Œé€éæŒ‡æ¨™å€¼çš„æ¯”è¼ƒå¯ä»¥åˆ¤æ–·FIFOçš„ç©ºæ»¿ç‹€æ…‹ã€‚

- æ»¿/ç©ºæ¨™èªŒé‚è¼¯:  
    - **æ»¿:** ç•¶å¯«å…¥æŒ‡é‡è¿½ä¸Šè®€å–æŒ‡é‡æ™‚ï¼ŒFIFO ç‚ºæ»¿ã€‚ æ›´ç²¾ç¢ºåœ°èªªï¼Œå¦‚æœä¸‹ä¸€æ¬¡å¯«å…¥å°‡ä½¿ wr_ptr ç­‰æ–¼ rd_ptrï¼Œä¸¦ä¸”ç•¶å‰æ­£åœ¨åŸ·è¡Œå¯«å…¥æ“ä½œï¼Œå‰‡ FIFO ç‚ºæ»¿ã€‚  

    - **ç©º:** ç•¶è®€å–æŒ‡é‡è¿½ä¸Šå¯«å…¥æŒ‡é‡æ™‚ï¼ŒFIFO ç‚ºç©ºã€‚ æ›´ç²¾ç¢ºåœ°èªªï¼Œå¦‚æœä¸‹ä¸€æ¬¡è®€å–å°‡ä½¿ rd_ptr ç­‰æ–¼ wr_ptrï¼Œä¸¦ä¸”ç•¶å‰æ­£åœ¨åŸ·è¡Œè®€å–æ“ä½œï¼Œå‰‡ FIFO ç‚ºç©ºã€‚

    - **åˆå§‹ç‹€æ…‹:** ç•¶ wr_ptr ç­‰æ–¼ rd_ptr æ™‚ï¼ŒFIFO åˆå§‹ç‹€æ…‹ç‚ºç©ºã€‚  
    > æ³¨æ„: è¦è€ƒæ…®åˆ°é‡é ­é–‹å§‹çš„ç‹€æ³  
    > æ„æ€æ˜¯æŒ‡ **ç¹å› (Wrap-around)** çš„è€ƒæ…®: ç•¶æŒ‡é‡ç¹å›æ™‚ï¼Œç°¡å–®çš„æ¯”è¼ƒ wr_ptr == rd_ptr ç„¡æ³•å€åˆ†æ»¿å’Œç©ºã€‚ å› æ­¤ï¼Œé€šå¸¸ä½¿ç”¨é¡å¤–çš„ä¸€ä½ (extra bit) ä¾†æ“´å±•æŒ‡é‡ï¼Œä»¥å€åˆ†é€™äº›æƒ…æ³ã€‚   


- å®šç¾©é›»è·¯ä»‹é¢
``` verilog
module sync_fifo
#(
  parameter                       ADR_BIT =  6,
  parameter                       DAT_BIT = 32,
  parameter                       WEN_BIT =  1
)(
  input  logic                    clk,
  input  logic                    rst_n,

  //ç•¶ cs_en ç‚ºé«˜ä¸” wr_en ç‚ºé«˜æ™‚ï¼Œè¡¨ç¤ºä¸€å€‹å¯«å…¥è«‹æ±‚ã€‚
  //ç•¶ cs_en ç‚ºé«˜ä¸” wr_en ç‚ºä½æ™‚ï¼Œè¡¨ç¤ºä¸€å€‹è®€å–è«‹æ±‚ã€‚
  //ç•¶ cs_en ç‚ºä½æ™‚ï¼Œè¡¨ç¤ºæ²’æœ‰ä»»ä½•æ“ä½œè«‹æ±‚ã€‚
  input  logic [WEN_BIT-1: 0]     cs_en,          // higi activ  
  input  logic [WEN_BIT-1: 0]     wr_en,          // higi activ
  input  logic [DAT_BIT-1: 0]     wr_dat,


  output logic [DAT_BIT-1: 0]     rd_dat,
  output logic                    fifo_full,
  output logic                    fifo_empty,
  output logic [ADR_BIT : 0]      fifo_count      // for testbench display
);
```

## åŒæ­¥FIFOå®Œæ•´ç¨‹å¼ç¢¼
```verilog
// +FHDR--------------------------------------------------------------------------------------------------------- //
// Project ____________                                                                                           //
// File name __________ sync_fifo.sv                                                                              //
// Creator ____________ Yan, Wei-Ting                                                                             //
// Built Date _________ MMM-DD-YYYY                                                                               //
// Function ___________                                                                                           //
// Hierarchy __________                                                                                           //
//   Parent ___________                                                                                           //
//   Children _________                                                                                           //
// Revision history ___ Date        Author            Description                                                 //
//                  ___                                                                                           //
// -FHDR--------------------------------------------------------------------------------------------------------- //
//+...........+...................+.............................................................................. //
//3...........15..................35............................................................................. //
`timescale 1ns/10ps

module sync_fifo
#(
  parameter                       ADR_BIT =  6,
  parameter                       DAT_BIT = 32,
  parameter                       WEN_BIT =  1
)(
  input  logic                    clk,
  input  logic                    rst_n,

  input  logic [WEN_BIT-1: 0]     cs_en,          // higi activ
  input  logic [WEN_BIT-1: 0]     wr_en,          // higi activ
  input  logic [DAT_BIT-1: 0]     wr_dat,


  output logic [DAT_BIT-1: 0]     rd_dat,
  output logic                    fifo_full,
  output logic                    fifo_empty,
  output logic [ADR_BIT : 0]      fifo_count      // for testbench display
);

// tag COMPONENTs and SIGNALs declaration --------------------------------------------------------------------------

  //
  logic    [ADR_BIT     : 0]      wr_ptr;
  logic    [ADR_BIT     : 0]      rd_ptr;

  // RAM æ§åˆ¶ä¿¡è™Ÿ
  logic    [WEN_BIT-1   : 0]      ram_cen;
  logic    [WEN_BIT-1   : 0]      ram_wen;
  logic    [ADR_BIT-1   : 0]      ram_addr;
  logic    [DAT_BIT-1   : 0]      ram_wdata;
  logic    [DAT_BIT-1   : 0]      ram_rdata;

  // base on cs_en & wr_en
  logic                           rd_req;
  logic                           wr_req;
  logic                           wr_actual;
  logic                           rd_actual;

// tag OUTs assignment ---------------------------------------------------------------------------------------------
assign rd_dat      = ram_rdata;

// tag INs assignment ----------------------------------------------------------------------------------------------


// tag COMBINATIONAL LOGIC -----------------------------------------------------------------------------------------

//ç•¶ cs_en ç‚ºé«˜ä¸” wr_en ç‚ºé«˜æ™‚ï¼Œè¡¨ç¤ºä¸€å€‹å¯«å…¥è«‹æ±‚ã€‚
//ç•¶ cs_en ç‚ºé«˜ä¸” wr_en ç‚ºä½æ™‚ï¼Œè¡¨ç¤ºä¸€å€‹è®€å–è«‹æ±‚ã€‚
//ç•¶ cs_en ç‚ºä½æ™‚ï¼Œè¡¨ç¤ºæ²’æœ‰ä»»ä½•æ“ä½œè«‹æ±‚ã€‚
assign        rd_req              = (cs_en == 1'b1 && wr_en == 1'b0 );
assign        wr_req              = (cs_en == 1'b1 && wr_en == 1'b1 );

assign        wr_actual           = wr_req && !fifo_full;
assign        rd_actual           = !wr_actual && rd_req && !fifo_empty;

assign fifo_full   = ( wr_ptr[ADR_BIT] != rd_ptr[ADR_BIT]) && ( wr_ptr[ADR_BIT-1 : 0] == rd_ptr[ADR_BIT-1 : 0] );
assign fifo_empty  = ( wr_ptr == rd_ptr);
assign fifo_count  = wr_ptr - rd_ptr;                 // for testbench display

// tag COMBINATIONAL PROCESS ---------------------------------------------------------------------------------------
always_comb begin
  ram_cen                         = {WEN_BIT{1'b1}};
  ram_wen                         = {WEN_BIT{1'b1}};
  ram_addr                        = 'd0;
  ram_wdata                       = 'd0;

  if ( wr_actual ) begin
  ram_cen                         = {WEN_BIT{1'b0}};
  ram_wen                         = {WEN_BIT{1'b0}};
  ram_addr                        = wr_ptr[ADR_BIT-1:0];
  ram_wdata                       = wr_dat;
  end else if ( rd_actual ) begin
  ram_cen                         = {WEN_BIT{1'b0}};
  ram_wen                         = {WEN_BIT{1'b1}};
  ram_addr                        = rd_ptr[ADR_BIT-1:0];
  end

end

// tag SEQUENTIAL LOGIC --------------------------------------------------------------------------------------------
// ***********************/**/**\**\****/**/**\**\****/**/**\**\****/**/**\**\****/**/**\**\****/**/**\**\****/**/**
//                       /**/****\**\**/**/****\**\**/**/****\**\**/**/****\**\**/**/****\**\**/**/****\**\**/**/***
// *********************/**/******\**\/**/******\**\/**/******\**\/**/******\**\/**/******\**\/**/******\**\/**/****
always @ (posedge clk or negedge rst_n) begin
  if (~rst_n) begin

  end else begin

  end
end

 sim_ram_top #(
  .ADR_BIT ( ADR_BIT       ),
  .DAT_BIT ( DAT_BIT       ),
  .WEN_BIT ( WEN_BIT       )
) u_ram (
  .clk     ( clk       ),
  .rst_n   ( rst_n     ),
  .CEN     ( ram_cen   ),  //low activ
  .WEN     ( ram_wen   ),  //low activ
  .addr    ( ram_addr  ),
  .w_data  ( ram_wdata ),
  .r_data  ( ram_rdata )
);

// ***********************/**/**\**\****/**/**\**\****/**/**\**\****/**/**\**\****/**/**\**\****/**/**\**\****/**/**
// è®€å¯«æŒ‡é‡æ›´æ–°            /**/****\**\**/**/****\**\**/**/****\**\**/**/****\**\**/**/****\**\**/**/****\**\**/**/***
// *********************/**/******\**\/**/******\**\/**/******\**\/**/******\**\/**/******\**\/**/******\**\/**/****
always_ff @ ( posedge clk or negedge rst_n) begin
  if ( !rst_n ) begin
    wr_ptr <= {ADR_BIT{1'b0}};
  end else begin
    if ( wr_actual ) begin
      wr_ptr <= wr_ptr + 1'b1;
    end else begin
      wr_ptr <= wr_ptr;
    end


  end
end

always_ff @ ( posedge clk or negedge rst_n) begin
  if ( !rst_n ) begin
    rd_ptr <= {ADR_BIT{1'b0}};
  end else begin
    if ( rd_actual ) begin
      rd_ptr <= rd_ptr + 1'b1;
    end else begin
      rd_ptr <= rd_ptr;
    end


  end
end
// ***********************/**/**\**\****/**/**\**\****/**/**\**\****/**/**\**\****/**/**\**\****/**/**\**\****/**/**
//                       /**/****\**\**/**/****\**\**/**/****\**\**/**/****\**\**/**/****\**\**/**/****\**\**/**/***
// *********************/**/******\**\/**/******\**\/**/******\**\/**/******\**\/**/******\**\/**/******\**\/**/****


endmodule
```

## åŒæ­¥FIFO testbenchç¨‹å¼ç¢¼
```verilog
// +FHDR--------------------------------------------------------------------------------------------------------- //
// Project ____________                                                                                           //
// File name __________ sim_sync_fifo.v                                                                              //
// Creator ____________ Yan, Wei-Ting                                                                             //
// Built Date _________ MMM-DD-YYYY                                                                               //
// Function ___________                                                                                           //
// Hierarchy __________                                                                                           //
//   Parent ___________                                                                                           //
//   Children _________                                                                                           //
// Revision history ___ Date        Author            Description                                                 //
//                  ___                                                                                           //
// -FHDR--------------------------------------------------------------------------------------------------------- //
//+...........+...................+.............................................................................. //
//3...........15..................35............................................................................. //
//`timescale 1ns/10ps

// test pattern
//1. å¯«å…¥æ¸¬è©¦ï¼šé€£çºŒå¯«å…¥æ•¸æ“šç›´åˆ° FIFO æ»¿
//2. è®€å–æ¸¬è©¦ï¼šé€£çºŒè®€å–ç›´åˆ° FIFO ç©º
//3. è®€å¯«äº¤æ›¿æ¸¬è©¦


module sim_sync_fifo;

// tag COMPONENTs and SIGNALs declaration --------------------------------------------------------------------------
  //localparam STIM = "./vectors/stim_zero.txt";
  parameter                       ADR_BIT =  6;
  parameter                       DAT_BIT = 32;
  parameter                       WEN_BIT =  1;

  logic                           ref_clk_i;
  logic                           slow_clk_i;
  logic                           test_clk_i;
  logic                           rstn_glob_i;

// tag OUTs assignment ---------------------------------------------------------------------------------------------
// tag INs assignment ----------------------------------------------------------------------------------------------
// tag COMBINATIONAL LOGIC -----------------------------------------------------------------------------------------
// tag COMBINATIONAL PROCESS ---------------------------------------------------------------------------------------
// tag SEQUENTIAL LOGIC --------------------------------------------------------------------------------------------
// ***********************/**/**\**\****/**/**\**\****/**/**\**\****/**/**\**\****/**/**\**\****/**/**\**\****/**/**
//                       /**/****\**\**/**/****\**\**/**/****\**\**/**/****\**\**/**/****\**\**/**/****\**\**/**/***
// *********************/**/******\**\/**/******\**\/**/******\**\/**/******\**\/**/******\**\/**/******\**\/**/****
// clock gen
tb_clk_gen #(
    //.CLK_PERIOD(REF_CLK_PERIOD)
    .CLK_PERIOD(3.33)   // 5 --> 200MHz
  ) i_ref_clk_gen (
    .clk_o(ref_clk_i)
  );
// ***********************/**/**\**\****/**/**\**\****/**/**\**\****/**/**\**\****/**/**\**\****/**/**\**\****/**/**
//                       /**/****\**\**/**/****\**\**/**/****\**\**/**/****\**\**/**/****\**\**/**/****\**\**/**/***
// *********************/**/******\**\/**/******\**\/**/******\**\/**/******\**\/**/******\**\/**/******\**\/**/****

  //fufo input
  logic       [WEN_BIT-1   : 0]   cs_en;
  logic       [WEN_BIT-1   : 0]   wr_en;
  logic       [DAT_BIT-1   : 0]   wr_dat;
  logic       [DAT_BIT-1   : 0]   rd_dat;

  //fifo optput
  logic                           fifo_full;
  logic                           fifo_empty;
  logic       [ADR_BIT : 0]       fifo_count;

sync_fifo #(
  .ADR_BIT    (   ADR_BIT         ),
  .DAT_BIT    (   DAT_BIT         ),
  .WEN_BIT    (   WEN_BIT         )
) i_sync_fifo (
  .clk        (   ref_clk_i       ),
  .rst_n      (   rstn_glob_i     ),
  .cs_en      (   cs_en           ), // high activ
  .wr_en      (   wr_en           ), // high activ
  .wr_dat     (   wr_dat          ),
  .rd_dat     (   rd_dat          ),
  .fifo_full  (   fifo_full       ),
  .fifo_empty (   fifo_empty      ),
  .fifo_count (   fifo_count      )
);

// ***********************/**/**\**\****/**/**\**\****/**/**\**\****/**/**\**\****/**/**\**\****/**/**\**\****/**/**
//                       /**/****\**\**/**/****\**\**/**/****\**\**/**/****\**\**/**/****\**\**/**/****\**\**/**/***
// *********************/**/******\**\/**/******\**\/**/******\**\/**/******\**\/**/******\**\/**/******\**\/**/****
initial begin
    $fsdbDumpfile("./sim_sync_fifo.fsdb");
    $fsdbDumpvars(0, sim_sync_fifo, "+all");
    $fsdbDumpMDA;
  end

initial begin
  rstn_glob_i   = 1'b0;
  #15
  rstn_glob_i   = 1'b1;
end


// test pattern
//1. å¯«å…¥æ¸¬è©¦ï¼šé€£çºŒå¯«å…¥æ•¸æ“šç›´åˆ° FIFO æ»¿
//2. è®€å–æ¸¬è©¦ï¼šé€£çºŒè®€å–ç›´åˆ° FIFO ç©º
//3. è®€å¯«äº¤æ›¿æ¸¬è©¦

initial begin
  cs_en        = 1'b0;
  wr_en        = 1'b0;
  wr_dat       = 'd0;
  #20


  for (int i = 0; i <66 ; i++)begin
    @(posedge ref_clk_i);
    if ( ~fifo_full ) begin
      cs_en  = 1'b1;
      wr_en  = 1'b1;
      wr_dat = i;
      $display("Time=%0t, -----  FIFO Not Full at %0d", $time, wr_dat);
    end else begin
      wr_en  = 1'b0;
      wr_dat = 0;
      $display("Time=%0t, -----  FIFO full at %0d", $time, wr_dat);
      break;
    end
  end


  wr_en  = 1'b0;
  for (int i = 0; i <66 ; i++)begin
    @(posedge ref_clk_i);
    if ( ~fifo_empty ) begin
      cs_en  = 1'b1;
      //@(posedge ref_clk_i);
      $display("Time=%0t, -----  Read data: %0d", $time, rd_dat);
    end else begin
      $display("Time=%0t, -----  Read data: %0d", $time, rd_dat);
      $display("Time=%0t, -----  FIFO empty at %0d", $time, i);
      break;
    end
  end

  #30
  $finish;

end


  // ç›£æ§ FIFO ç‹€æ…‹
  initial begin
    forever begin
      @(posedge ref_clk_i);
      $display("Time=%0t, Full=%0d, Empty=%0d, Count=%0d",
               $time, fifo_full, fifo_empty, fifo_count);
    end
  end

endmodule
```


##
**ğŸ§  å•é¡Œï¼š**  
åŒæ­¥ FIFO ä¸­ï¼Œåœ¨åŒä¸€å€‹æ™‚é˜é‚Šç·£ï¼Œå¦‚æœï¼š
å¯«å…¥è³‡æ–™åˆ°åœ°å€ Aï¼ˆwrite pointer æŒ‡å‘ Aï¼‰ï¼ŒåŒæ™‚è®€å‡ºè³‡æ–™ï¼ˆread pointer ä¹ŸæŒ‡å‘ Aï¼‰
é‚£éº¼ï¼Œè®€å‡ºä¾†çš„è³‡æ–™æ˜¯ä»€éº¼ï¼Ÿæ˜¯ã€ŒåŸæœ¬å­˜åœ¨ A çš„å€¼ã€ï¼Œé‚„æ˜¯ã€Œå‰›å¯«é€² A çš„æ–°å€¼ã€ï¼Ÿ

**ğŸ“Œ ç­”æ¡ˆï¼š**  
è¦– FIFO è¨˜æ†¶é«”çš„å¯«å…¥ï¼è®€å‡ºæ™‚åºè¡Œç‚ºè€Œå®šï¼
ä¹Ÿå°±æ˜¯èªªï¼šé€™å–æ±ºæ–¼åº•å±¤ memory çš„è¡Œç‚ºï¼ˆé€šå¸¸æ˜¯ RTL ä¸­çš„ RAM module çš„è¡Œç‚ºï¼‰ã€‚

**ğŸ“š å¸¸è¦‹å…©ç¨®æƒ…æ³ï¼š**
1ï¸âƒ£ å¯«åœ¨å‰ï¼Œè®€åˆ°æ–°è³‡æ–™ï¼ˆWrite-first behaviorï¼‰
- å¯«å…¥èˆ‡è®€å‡ºåŒä¸€åœ°å€ï¼Œåœ¨åŒä¸€å€‹æ™‚é˜é‚Šç·£ã€‚
- çµæœï¼šè®€å‡ºå‰›å¯«é€²å»çš„æ–°è³‡æ–™ã€‚

ğŸ“Œ é©åˆæœ‰äº›åŒæ­¥ FIFO çš„éœ€æ±‚ï¼Œå°¤å…¶æ˜¯ latency æ•æ„Ÿçš„æ‡‰ç”¨ã€‚

2ï¸âƒ£ è®€åœ¨å‰ï¼Œè®€åˆ°èˆŠè³‡æ–™ï¼ˆRead-first behaviorï¼‰
- åŒæ¨£å¯«å…¥èˆ‡è®€å‡ºåŒä¸€åœ°å€ã€‚
- çµæœï¼šè®€å‡ºçš„æ˜¯åŸæœ¬å­˜åœ¨çš„èˆŠè³‡æ–™ï¼ˆé‚„æ²’å¯«é€²å»çš„ï¼‰ã€‚

ğŸ“Œ åœ¨æŸäº›è¨˜æ†¶é«” IP æˆ–æ˜¯åˆæˆå·¥å…·ä¸­çš„ RAMï¼Œé è¨­æ˜¯é€™ç¨®è¡Œç‚ºã€‚

**âœ… è¨­è¨ˆå»ºè­°ï¼š**
ç‚ºäº†é¿å…é€™ç¨®æ¨¡ç³Šç‹€æ³ï¼Œé€šå¸¸æœƒå¼·åˆ¶åœ¨ write å’Œ read æŒ‡æ¨™ä¸åŒæ™‚æ‰å…è¨±æ“ä½œï¼Œæˆ–æ˜¯åŠ ä¸€å±¤ä¿è­·é‚è¼¯ï¼Œä¾‹å¦‚ï¼š
- åªæœ‰ç•¶ FIFO ä¸­æœ‰è³‡æ–™æ‰å…è¨±è®€ï¼ˆé¿å…ç©ºè®€ï¼‰ã€‚
- åªæœ‰ç•¶ FIFO é‚„æ²’æ»¿æ‰å…è¨±å¯«ï¼ˆé¿å…è¦†è“‹ï¼‰ã€‚

è‹¥è¦æ”¯æ´åŒæ­¥å¯«è®€åŒåœ°å€ï¼Œè¨˜æ†¶é«”æ¨¡çµ„å¿…é ˆè¨­è¨ˆæˆ write-first æˆ– read-firstï¼Œä¸¦åœ¨æ–‡ä»¶ä¸­èªªæ˜ã€‚


## ç•°æ­¥FIFO(Asynchronous FIFO)è¨­è¨ˆ






## Reference
1. [åŒæ­¥FIFOçš„å…©ç¨®Verilogè¨­è¨ˆæ–¹æ³•] (https://blog.csdn.net/wuzhikaidetb/article/details/121136040)
